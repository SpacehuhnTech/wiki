<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.108.0"><meta name=description content><link rel=icon href=/images/favicon.png type=image/png><title>Translate Keyboard Layout :: Spacehuhn Wiki</title><link href=/css/nucleus.css?1670616520 rel=stylesheet><link href=/css/fontawesome-all.min.css?1670616520 rel=stylesheet><link href=/css/hybrid.css?1670616520 rel=stylesheet><link href=/css/featherlight.min.css?1670616520 rel=stylesheet><link href=/css/perfect-scrollbar.min.css?1670616520 rel=stylesheet><link href=/css/auto-complete.css?1670616520 rel=stylesheet><link href=/css/atom-one-dark-reasonable.css?1670616520 rel=stylesheet><link href=/css/theme.css?1670616520 rel=stylesheet><link href=/css/hugo-theme.css?1670616520 rel=stylesheet><link href=/css/theme-spacehuhn.css?1670616520 rel=stylesheet><script src=/js/jquery-3.3.1.min.js?1670616520></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=/wifiduck/development/translatekeyboardlayout/><nav id=sidebar class=showVisitedLinks><div id=header-wrapper><div id=header><a id=logo href=https://spacehuhn.wiki/><img src=/media/spacehuhn_wiki_logo.png alt="Spacehuhn Wiki Logo"></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=/js/lunr.min.js?1670616520></script>
<script type=text/javascript src=/js/auto-complete.js?1670616520></script>
<script type=text/javascript>var baseurl="https://spacehuhn.wiki/"</script><script type=text/javascript src=/js/search.js?1670616520></script></div><div class=highlightable><ul class=topics><li data-nav-id=/deauther/ title="ESP8266 Deauther" class=dd-item><a href=/deauther/>ESP8266 Deauther
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/deauther/supporteddevices/ title="Supported Devices" class=dd-item><a href=/deauther/supporteddevices/>Supported Devices
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/deauther/supporteddevices/dstikeboards/ title="Dstike Boards" class=dd-item><a href=/deauther/supporteddevices/dstikeboards/>Dstike Boards
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/deauther/supporteddevices/nodemcu/ title="Node MCU" class=dd-item><a href=/deauther/supporteddevices/nodemcu/>Node MCU
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/deauther/supporteddevices/wemos/ title=Wemos class=dd-item><a href=/deauther/supporteddevices/wemos/>Wemos
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/deauther/supporteddevices/adafruit/ title=Adafruit class=dd-item><a href=/deauther/supporteddevices/adafruit/>Adafruit
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/deauther/supporteddevices/fakeboards/ title="Fake Boards" class=dd-item><a href=/deauther/supporteddevices/fakeboards/>Fake Boards
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/deauther/installation/ title=Installation class=dd-item><a href=/deauther/installation/>Installation
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/deauther/installation/tutorial/ title=Tutorial class=dd-item><a href=/deauther/installation/tutorial/>Tutorial
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/deauther/installation/flashing/ title=Flashing class=dd-item><a href=/deauther/installation/flashing/>Flashing
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/deauther/installation/flashing/esptool/ title=Esptool class=dd-item><a href=/deauther/installation/flashing/esptool/>Esptool
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/deauther/installation/flashing/nodemcu/ title=NodeMCU class=dd-item><a href=/deauther/installation/flashing/nodemcu/>NodeMCU
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/deauther/installation/compiling/ title="Compiling using Arduino IDE" class=dd-item><a href=/deauther/installation/compiling/>Compiling using Arduino IDE
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/deauther/installation/upload/ title="Upload settings" class=dd-item><a href=/deauther/installation/upload/>Upload settings
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/deauther/installation/tips/ title="Installation tips and tricks" class=dd-item><a href=/deauther/installation/tips/>Installation tips and tricks
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/deauther/setup/ title="Setup Display & Buttons" class=dd-item><a href=/deauther/setup/>Setup Display & Buttons
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/deauther/setup/need/ title=Tools class=dd-item><a href=/deauther/setup/need/>Tools
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/deauther/setup/wire/ title="Wire everything up" class=dd-item><a href=/deauther/setup/wire/>Wire everything up
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/deauther/setup/wire/display_button/ title="Display, Buttons & LED" class=dd-item><a href=/deauther/setup/wire/display_button/>Display, Buttons & LED
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/deauther/setup/wire/example/ title=Examples class=dd-item><a href=/deauther/setup/wire/example/>Examples
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/deauther/setup/adjust/ title="Adjust code" class=dd-item><a href=/deauther/setup/adjust/>Adjust code
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/deauther/setup/testing/ title=Testing class=dd-item><a href=/deauther/setup/testing/>Testing
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/deauther/usage/ title=Usage class=dd-item><a href=/deauther/usage/>Usage
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/deauther/usage/web/ title=Web class=dd-item><a href=/deauther/usage/web/>Web
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/deauther/usage/oled/ title="Oled Display" class=dd-item><a href=/deauther/usage/oled/>Oled Display
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/deauther/usage/serial/ title="Serial Usage" class=dd-item><a href=/deauther/usage/serial/>Serial Usage
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/deauther/faq/ title=FAQ class=dd-item><a href=/deauther/faq/>FAQ
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/deauther/projects/ title=Projects class=dd-item><a href=/deauther/projects/>Projects
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/deauther/commands/ title="Serial Commands" class=dd-item><a href=/deauther/commands/>Serial Commands
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/deauther/settings/ title=Settings class=dd-item><a href=/deauther/settings/>Settings
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/deauther/scripts/ title="Writing Scripts" class=dd-item><a href=/deauther/scripts/>Writing Scripts
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/deauther/development/ title=Development class=dd-item><a href=/deauther/development/>Development
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/deauther/troubleshooting/ title=Troubleshooting class=dd-item><a href=/deauther/troubleshooting/>Troubleshooting
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/wifiduck/ title="WiFi Duck" class="dd-item
parent"><a href=/wifiduck/>WiFi Duck
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/wifiduck/about/ title=About class=dd-item><a href=/wifiduck/about/>About
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/wifiduck/disclaimer/ title=Disclaimer class=dd-item><a href=/wifiduck/disclaimer/>Disclaimer
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/wifiduck/hardware/ title=Hardware class=dd-item><a href=/wifiduck/hardware/>Hardware
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/wifiduck/hardware/requirements/ title=Requirements class=dd-item><a href=/wifiduck/hardware/requirements/>Requirements
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/wifiduck/hardware/supportedboards/ title="Supported Boards" class=dd-item><a href=/wifiduck/hardware/supportedboards/>Supported Boards
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/wifiduck/hardware/connections/ title=Connections class=dd-item><a href=/wifiduck/hardware/connections/>Connections
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/wifiduck/hardware/pcb/ title=PCBs class=dd-item><a href=/wifiduck/hardware/pcb/>PCBs
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/wifiduck/hardware/dstike/ title="DSTIKE WiFi Duck" class=dd-item><a href=/wifiduck/hardware/dstike/>DSTIKE WiFi Duck
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/wifiduck/software/ title="Flash Software" class=dd-item><a href=/wifiduck/software/>Flash Software
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/wifiduck/software/preparations/ title=Preparations class=dd-item><a href=/wifiduck/software/preparations/><b>1.</b>&nbsp;Preparations
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/wifiduck/software/atmega/ title="Flash Atmega32u4" class=dd-item><a href=/wifiduck/software/atmega/><b>2.</b>&nbsp;Flash Atmega32u4
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/wifiduck/software/esp8266/ title="Flash ESP8266" class=dd-item><a href=/wifiduck/software/esp8266/><b>3.</b>&nbsp;Flash ESP8266
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/wifiduck/troubleshooting/ title=Troubleshooting class=dd-item><a href=/wifiduck/troubleshooting/>Troubleshooting
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/wifiduck/usage/ title=Usage class=dd-item><a href=/wifiduck/usage/>Usage
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/wifiduck/usage/duckyscript/ title="Ducky Script" class=dd-item><a href=/wifiduck/usage/duckyscript/>Ducky Script
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/wifiduck/usage/cli/ title=CLI class=dd-item><a href=/wifiduck/usage/cli/>CLI
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/wifiduck/usage/debug/ title=Debug class=dd-item><a href=/wifiduck/usage/debug/>Debug
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/wifiduck/faq/ title=FAQ class=dd-item><a href=/wifiduck/faq/>FAQ
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/wifiduck/development/ title=Development class="dd-item
parent"><a href=/wifiduck/development/>Development
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/wifiduck/development/webfiles/ title="Edit Web Files" class=dd-item><a href=/wifiduck/development/webfiles/>Edit Web Files
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/wifiduck/development/translatekeyboardlayout/ title="Translate Keyboard Layout" class="dd-item active"><a href=/wifiduck/development/translatekeyboardlayout/>Translate Keyboard Layout
<i class="fas fa-check read-icon"></i></a></li></ul></li></ul></li></ul><section id=prefooter><hr><ul><li><a class=padding href=# data-clear-history-toggle><i class="fas fa-history fa-fw"></i> Clear History</a></li></ul></section><section id=footer><p><a href=https://github.com/spacehuhntech/wiki><i class="fab fa-github"></i>&nbsp;Hosted on Github</a></p></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span>
<span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links><a href=/></a> > <a href=/wifiduck/>WiFi Duck</a> > <a href=/wifiduck/development/>Development</a> > Translate Keyboard Layout</span></div><div class=progress><div class=wrapper><nav id=TableOfContents></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Translate Keyboard Layout</h1><p>Currently the supported keyboard layouts are:</p><ul><li><a href=https://github.com/spacehuhn/WiFiDuck/blob/master/atmega_duck/locale_de.h>DE</a></li><li><a href=https://github.com/spacehuhn/WiFiDuck/blob/master/atmega_duck/locale_gb.h>GB</a></li><li><a href=https://github.com/spacehuhn/WiFiDuck/blob/master/atmega_duck/locale_us.h>US</a></li><li><a href=https://github.com/spacehuhn/WiFiDuck/blob/master/atmega_duck/locale_es.h>ES</a></li><li><a href=https://github.com/spacehuhn/WiFiDuck/blob/master/atmega_duck/locale_ru.h>RU (WIP)</a></li><li><a href=https://github.com/spacehuhn/WiFiDuck/blob/master/atmega_duck/locale_fr.h>FR (ASCII only)</a></li></ul><p>All standard keys are defined in <a href=https://github.com/spacehuhn/WiFiDuck/blob/master/atmega_duck/usb_hid_keys.h>usb_hid_keys.h</a>.<br>To translate a keyboard layout, you have to match each character on
your keyboard to the one(s) of a US keyboard.<br>This stuff is hard to explain in writing and requires a lot of manual work and testing.</p><ol><li>Copy one of the existing layouts files, like <a href=https://github.com/spacehuhn/WiFiDuck/blob/master/atmega_duck/locale_us.h>locale_us.h</a>.<br>Preferably one that is close to your keyboard layout, it will save you time!</li><li>Add <code>#include "locale_xx.h"</code> to the end of the locales.h file.</li><li>Rename the file and its variables to your language code.
For example:<br><code>locale_xx.h</code> -> <code>locale_de.h</code>,<br><code>ascii_xx</code> -> <code>ascii_de</code>,<br><code>locale_xx</code> -> <code>locale_de</code>,<br><code>extended_ascii_xx</code> -> <code>extended_ascii_de</code>,<br><code>utf8_xx</code> -> <code>utf8_de</code>.</li><li>Modify the ASCII array.<br>The ASCII array has a fixed size. Each row describes a key.
First a modifier key like <code>KEY_MOD_LSHIFT</code>, then a character key.
Some ASCII characters can&rsquo;t be typed or don&rsquo;t require a modifier,
that&rsquo;s where you must place <code>KEY_NONE</code>.
Check <a href=https://github.com/spacehuhn/WiFiDuck/blob/master/atmega_duck/usb_hid_keys.h>usb_hid_keys.h</a> for the available keys.<br>If multiple modifiers are required, you must use a bitwise OR to connect them: <code>KEY_MOD_RALT | KEY_MOD_LSHIFT</code>.<br>For example, in <a href=https://github.com/spacehuhn/WiFiDuck/blob/master/atmega_duck/locale_de.h#L136>locale_de.h</a> <code>Z</code> is saved as <code>KEY_MOD_LSHIFT, KEY_Y</code>.<br>This is because German keyboards use QWERTZ instead of the QWERTY layout
and since the letter is uppercase, shift must be pressed as well.<br>Thankfully you don&rsquo;t have to trial and error everything, the Hak5 Community
translated a lot of layouts already <a href=https://github.com/hak5darren/USB-Rubber-Ducky/tree/master/Encoder/resources>here</a>. It&rsquo;s just written in a different syntax. For example, <code>ASCII_20</code> (20 in hexadecimal) is the 32th character in our ascii array.</li><li>Modify or create the extended ASCII array.<br>The extended ASCII array doesn&rsquo;t have a fixed size and is only as long as you make it.
First the character code. For example, <a href=https://theasciicode.com.ar/extended-ascii-code/letter-a-umlaut-diaeresis-a-umlaut-lowercase-ascii-code-132.html>ä</a> has the index 132, or 84 in hex.
It doesn&rsquo;t use a modifier and sits where the apostrophe key is on a US keyboard:
<code>0x84, KEY_NONE, KEY_APOSTROPHE, // ä</code>.</li><li>Modify or create the UTF-8 array.<br>The UTF-8 array is variable in length, too.<br>The first 4 bytes are the character code.<br>For example, <a href=https://www.fileformat.info/info/unicode/char/00c4/index.htm>Ä</a> has the hex code c384 or 0xc3 0x84. The other 2 bytes are not used so we set them to 0.
Because the letter is uppercase, we need to press the shift key and like before, the letter is typed by pressing the same key as the apostrophe key of a US keyboard: <code>0xc3, 0x84, 0x00, 0x00, KEY_MOD_LSHIFT, KEY_APOSTROPHE, // Ä</code>.</li><li>Edit the hid_locale_t structure.<br>If you renamed all variables accordingly, there&rsquo;s nothing left to do.</li><li>Go to <a href=https://github.com/spacehuhn/WiFiDuck/blob/master/atmega_duck/duckparser.cpp#L163>duckparser.cpp</a> at <code>// LOCALE (-> change keyboard layout)</code> you can see a bunch of else if statements.
You need to copy one for your layout.</li></ol><p>Before adding GB layout:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>compare</span>(w<span style=color:#f92672>-&gt;</span>str, w<span style=color:#f92672>-&gt;</span>len, <span style=color:#e6db74>&#34;US&#34;</span>, CASE_SENSETIVE)) {
</span></span><span style=display:flex><span>    keyboard<span style=color:#f92672>::</span><span style=color:#a6e22e>setLocale</span>(<span style=color:#f92672>&amp;</span>locale_us);
</span></span><span style=display:flex><span>} <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>compare</span>(w<span style=color:#f92672>-&gt;</span>str, w<span style=color:#f92672>-&gt;</span>len, <span style=color:#e6db74>&#34;DE&#34;</span>, CASE_SENSETIVE)) {
</span></span><span style=display:flex><span>    keyboard<span style=color:#f92672>::</span><span style=color:#a6e22e>setLocale</span>(<span style=color:#f92672>&amp;</span>locale_de);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>After adding GB layout:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>compare</span>(w<span style=color:#f92672>-&gt;</span>str, w<span style=color:#f92672>-&gt;</span>len, <span style=color:#e6db74>&#34;US&#34;</span>, CASE_SENSETIVE)) {
</span></span><span style=display:flex><span>    keyboard<span style=color:#f92672>::</span><span style=color:#a6e22e>setLocale</span>(<span style=color:#f92672>&amp;</span>locale_us);
</span></span><span style=display:flex><span>} <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>compare</span>(w<span style=color:#f92672>-&gt;</span>str, w<span style=color:#f92672>-&gt;</span>len, <span style=color:#e6db74>&#34;DE&#34;</span>, CASE_SENSETIVE)) {
</span></span><span style=display:flex><span>    keyboard<span style=color:#f92672>::</span><span style=color:#a6e22e>setLocale</span>(<span style=color:#f92672>&amp;</span>locale_de);
</span></span><span style=display:flex><span>} <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>compare</span>(w<span style=color:#f92672>-&gt;</span>str, w<span style=color:#f92672>-&gt;</span>len, <span style=color:#e6db74>&#34;GB&#34;</span>, CASE_SENSETIVE)) {
</span></span><span style=display:flex><span>   keyboard<span style=color:#f92672>::</span><span style=color:#a6e22e>setLocale</span>(<span style=color:#f92672>&amp;</span>locale_gb);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=9><li>Test your layout with a Ducky Script that contains all characters of your keyboard. For example:</li></ol><pre tabindex=0><code>LOCALE DE
STRING !&#34;#$%&amp;&#39;()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]^_abcdefghijklmnopqrstuvwxyz{|}~²³äöüÄÖÜß€°§`
ENTER
</code></pre><ol start=10><li>Add a link to your layout to <a href=README.md>README</a>, to <a href=web/index.html>web/index.html</a> and please feel free to improve this tutorial to help future translators!</li><li><a href=https://help.github.com/en/articles/creating-a-pull-request>Create a Pull Request</a></li></ol><hr><script defer data-domain=spacehuhn.wiki src=https://plausible.io/js/plausible.js></script><footer class=footline></footer></div></div><div id=navigation><a class="nav nav-prev" href=/wifiduck/development/webfiles/ title="Edit Web Files"><i class="fa fa-chevron-left"></i></a>
<a class="nav nav-next" href=/wifiduck/development/webfiles/ title="Edit Web Files" style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/js/clipboard.min.js?1670616520></script>
<script src=/js/perfect-scrollbar.min.js?1670616520></script>
<script src=/js/perfect-scrollbar.jquery.min.js?1670616520></script>
<script src=/js/jquery.sticky.js?1670616520></script>
<script src=/js/featherlight.min.js?1670616520></script>
<script src=/js/highlight.pack.js?1670616520></script>
<script>hljs.initHighlightingOnLoad()</script><script src=/js/modernizr.custom-3.6.0.js?1670616520></script>
<script src=/js/learn.js?1670616520></script>
<script src=/js/hugo-learn.js?1670616520></script>
<link href=/mermaid/mermaid.css?1670616520 rel=stylesheet><script src=/mermaid/mermaid.js?1670616520></script>
<script>mermaid.initialize({startOnLoad:!0})</script></body></html>